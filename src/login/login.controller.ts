import { Body, Controller, Get, HttpException, HttpStatus, Post, Res } from '@nestjs/common';
import { ApiBearerAuth, ApiOperation, ApiProperty, ApiResponse, ApiTags } from '@nestjs/swagger';
import { LoginDTO } from 'src/shared/DTO`s/login.DTO';
import { LoginService } from './login.service';
import { Response } from 'express';

@ApiBearerAuth()
@ApiTags('login')
@Controller('login')
export class LoginController {
    constructor(private readonly loginService: LoginService) {}


    @Post()
    @ApiOperation({ summary: 'login user', description: 'use username: admin and password: 123456' })
    @ApiResponse({ status: 400, description: 'username or password is incorrect!' })
    async create(@Body() loginDTO: LoginDTO, @Res() res: Response): Promise<any> {
        if (this.loginService.loginUser(loginDTO)) 
            res.status(HttpStatus.OK).json('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2MTJiNzk2MGQxNzdjZTAwMzg2Y2MxOTciLCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwicGVybWlzc2lvbnMiOlsiYWRtaW5fc2VjdGlvbiIsImFkbWluX3JlYWQiLCJhZG1pbl9jcmVhdGUiLCJicm9rZXJfc2VjdGlvbiIsImJyb2tlcl9yZWFkIiwiYnJva2VyX2NyZWF0ZSIsImJyb2tlcl9zZW5kX3Bhc3N3b3JkIiwiYnJva2VyX3JlcXVlc3RfcmVhZCIsInJlcXVlc3Rfc21lX3VwZGF0ZSIsInNtZV9yZWFkIiwiYnJva2VyX3JlcXVlc3RfcGF5bWVudF9pbWFnZSIsImNvbGxlY3R0aW1lX3NlY3Rpb24iLCJjb2xsZWN0dGltZV9yZWFkIiwiY29sbGVjdHRpbWVfY3JlYXRlIiwiY29sbGVjdHRpbWVfdXBkYXRlIiwiY291cG9uYnJva2VyX3NlY3Rpb24iLCJjb3Vwb25icm9rZXJfcmVhZCIsImNvdXBvbmJyb2tlcl9jcmVhdGUiLCJjb3Vwb25icm9rZXJfdXBkYXRlIiwiY291cG9uX2NyZWF0ZSIsImNvdXJpZXJfc2VjdGlvbiIsImNvdXJpZXJfcmVhZCIsImNvdXJpZXJfdXBkYXRlIiwiY291cmllcl9jcmVhdGUiLCJjb3VyaWVyX2JpbGxfcmVhZCIsImN1c3RvbWVyX3NlY3Rpb24iLCJjdXN0b21lcl9yZWFkIiwiY3VzdG9tZXJfdXBkYXRlIiwiY3VzdG9tZXJfYWRkcmVzc19yZWFkIiwiYWRkcmVzc191cGRhdGUiLCJjdXN0b21lcl9kZXBvc2l0X3JlYWQiLCJkZXBvc2l0X3NlY3Rpb24iLCJkZXBvc2l0X3JlYWQiLCJkZXBvc2l0X3VwZGF0ZSIsImR1bXBfc2VjdGlvbiIsImR1bXBfcmVhZCIsImR1bXBfY3JlYXRlIiwiZHVtcF91cGRhdGUiLCJpbWFnZV9yZWFkIiwicmVxdWVzdF91bml2ZXJzYWxfc2VjdGlvbiIsInJlcXVlc3RfdW5pdmVyc2FsX3JlYWQiLCJ1bml2ZXJzYWxfY3VzdG9tZXJzX3NlY3Rpb24iLCJ1bml2ZXJzYWxfY3VzdG9tZXJzX3JlYWQiLCJyZXF1ZXN0X2hvbWVfc2VjdGlvbiIsInJlcXVlc3RfaG9tZSIsInJlcXVlc3Rfc2VsbF9zZWN0aW9uIiwicmVxdWVzdF9zZWxsIiwicmVxdWVzdF9zZWN0aW9uIiwicmVxdWVzdF9yZWFkIiwicmVxdWVzdF9hcHByb3ZlIiwicmVxdWVzdF9yZXNldCIsInJlcXVlc3RfYXNzaWduIiwicmVxdWVzdF9tb3ZlIiwicmVxdWVzdF9hcnJpdmUiLCJyZXF1ZXN0X2NvbGxlY3QiLCJyZXF1ZXN0X3JlamVjdCIsInJlcXVlc3RfY29sbGVjdHRpbWVfdXBkYXRlIiwicmVxdWVzdF9sb2dfcmVhZCIsInJlcXVlc3Rfc3VydmV5X3JlYWQiLCJyZXF1ZXN0X2NvbGxlY3Rfc2lnbl9pbWFnZSIsInJlcXVlc3RfcmVhZF9ub3RlIiwicmVxdWVzdF9hZGRfbm90ZSIsInJlcXVlc3RfZWRpdF9jb2xsZWN0ZWQiLCJyZXF1ZXN0X3JlYWRfdGFnIiwicmVxdWVzdF9zdWJtaXRfdGFnIiwicmVwb3J0X3NlY3Rpb24iLCJyZXBvcnRfcmVhZCIsInJlcG9ydF9jdXN0b21lciIsInJlcG9ydF9yZXF1ZXN0IiwicmVwb3J0X2NvdXJpZXIiLCJyZXBvcnRfY2FuY2VsbGVkX3JlcXVlc3RzIiwidGFnX3NlY3Rpb24iLCJ0YWdfcmVhZCIsInRhZ19jcmVhdGUiLCJjdXN0b21lcl9ob21lX3NlY3Rpb24iLCJjdXN0b21lcl9ob21lX3JlYWQiLCJhZG1pbl9zZWN0aW9uIiwiYWRtaW5fcmVhZCIsImFkbWluX2NyZWF0ZSIsImJyb2tlcl9zZWN0aW9uIiwiYnJva2VyX3JlYWQiLCJicm9rZXJfY3JlYXRlIiwiYnJva2VyX3NlbmRfcGFzc3dvcmQiLCJicm9rZXJfcmVxdWVzdF9yZWFkIiwicmVxdWVzdF9zbWVfdXBkYXRlIiwic21lX3JlYWQiLCJicm9rZXJfcmVxdWVzdF9wYXltZW50X2ltYWdlIiwiY29sbGVjdHRpbWVfc2VjdGlvbiIsImNvbGxlY3R0aW1lX3JlYWQiLCJjb2xsZWN0dGltZV9jcmVhdGUiLCJjb2xsZWN0dGltZV91cGRhdGUiLCJjb3Vwb25icm9rZXJfc2VjdGlvbiIsImNvdXBvbmJyb2tlcl9yZWFkIiwiY291cG9uYnJva2VyX2NyZWF0ZSIsImNvdXBvbmJyb2tlcl91cGRhdGUiLCJjb3Vwb25fY3JlYXRlIiwiY291cmllcl9zZWN0aW9uIiwiY291cmllcl9yZWFkIiwiY291cmllcl91cGRhdGUiLCJjb3VyaWVyX2NyZWF0ZSIsImNvdXJpZXJfYmlsbF9yZWFkIiwiY3VzdG9tZXJfc2VjdGlvbiIsImN1c3RvbWVyX3JlYWQiLCJjdXN0b21lcl91cGRhdGUiLCJjdXN0b21lcl9hZGRyZXNzX3JlYWQiLCJhZGRyZXNzX3VwZGF0ZSIsImN1c3RvbWVyX2RlcG9zaXRfcmVhZCIsImRlcG9zaXRfc2VjdGlvbiIsImRlcG9zaXRfcmVhZCIsImRlcG9zaXRfdXBkYXRlIiwiZHVtcF9zZWN0aW9uIiwiZHVtcF9yZWFkIiwiZHVtcF9jcmVhdGUiLCJkdW1wX3VwZGF0ZSIsImltYWdlX3JlYWQiLCJyZXF1ZXN0X3VuaXZlcnNhbF9zZWN0aW9uIiwicmVxdWVzdF91bml2ZXJzYWxfcmVhZCIsInVuaXZlcnNhbF9jdXN0b21lcnNfc2VjdGlvbiIsInVuaXZlcnNhbF9jdXN0b21lcnNfcmVhZCIsInJlcXVlc3RfaG9tZV9zZWN0aW9uIiwicmVxdWVzdF9ob21lIiwicmVxdWVzdF9zZWxsX3NlY3Rpb24iLCJyZXF1ZXN0X3NlbGwiLCJyZXF1ZXN0X3NlY3Rpb24iLCJyZXF1ZXN0X3JlYWQiLCJyZXF1ZXN0X2FwcHJvdmUiLCJyZXF1ZXN0X3Jlc2V0IiwicmVxdWVzdF9hc3NpZ24iLCJyZXF1ZXN0X21vdmUiLCJyZXF1ZXN0X2Fycml2ZSIsInJlcXVlc3RfY29sbGVjdCIsInJlcXVlc3RfcmVqZWN0IiwicmVxdWVzdF9jb2xsZWN0dGltZV91cGRhdGUiLCJyZXF1ZXN0X2xvZ19yZWFkIiwicmVxdWVzdF9zdXJ2ZXlfcmVhZCIsInJlcXVlc3RfY29sbGVjdF9zaWduX2ltYWdlIiwicmVxdWVzdF9yZWFkX25vdGUiLCJyZXF1ZXN0X2FkZF9ub3RlIiwicmVxdWVzdF9lZGl0X2NvbGxlY3RlZCIsInJlcXVlc3RfcmVhZF90YWciLCJyZXF1ZXN0X3N1Ym1pdF90YWciLCJyZXBvcnRfc2VjdGlvbiIsInJlcG9ydF9yZWFkIiwicmVwb3J0X2N1c3RvbWVyIiwicmVwb3J0X3JlcXVlc3QiLCJyZXBvcnRfY291cmllciIsInJlcG9ydF9jYW5jZWxsZWRfcmVxdWVzdHMiLCJ0YWdfc2VjdGlvbiIsInRhZ19yZWFkIiwidGFnX2NyZWF0ZSIsImN1c3RvbWVyX2hvbWVfc2VjdGlvbiIsImN1c3RvbWVyX2hvbWVfcmVhZCJdLCJpYXQiOjE2MzM4NTU0MzB9.FZQjsytnHdCjx6StLMs-lq6KRTSN_4BCdWepVQyPl3c');
        else 
            throw new HttpException('one of the username or password shoud incorrect!', HttpStatus.BAD_REQUEST)
    }
}
